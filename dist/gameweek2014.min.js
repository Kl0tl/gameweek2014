require=function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};b[g][0].call(j.exports,function(a){var c=b[g][1][a];return e(c?c:a)},j,j.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b){function c(){}var d=b.exports={};d.nextTick=function(){var a="undefined"!=typeof window&&window.setImmediate,b="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(a)return function(a){return window.setImmediate(a)};if(b){var c=[];return window.addEventListener("message",function(a){var b=a.source;if((b===window||null===b)&&"process-tick"===a.data&&(a.stopPropagation(),c.length>0)){var d=c.shift();d()}},!0),function(a){c.push(a),window.postMessage("process-tick","*")}}return function(a){setTimeout(a,0)}}(),d.title="browser",d.browser=!0,d.env={},d.argv=[],d.on=c,d.once=c,d.off=c,d.emit=c,d.binding=function(){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(){throw new Error("process.chdir is not supported")}},{}],2:[function(a,b,c){(function(a){function b(a,b){for(var c=0,d=a.length-1;d>=0;d--){var e=a[d];"."===e?a.splice(d,1):".."===e?(a.splice(d,1),c++):c&&(a.splice(d,1),c--)}if(b)for(;c--;c)a.unshift("..");return a}function d(a,b){if(a.filter)return a.filter(b);for(var c=[],d=0;d<a.length;d++)b(a[d],d,a)&&c.push(a[d]);return c}var e=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,f=function(a){return e.exec(a).slice(1)};c.resolve=function(){for(var c="",e=!1,f=arguments.length-1;f>=-1&&!e;f--){var g=f>=0?arguments[f]:a.cwd();if("string"!=typeof g)throw new TypeError("Arguments to path.resolve must be strings");g&&(c=g+"/"+c,e="/"===g.charAt(0))}return c=b(d(c.split("/"),function(a){return!!a}),!e).join("/"),(e?"/":"")+c||"."},c.normalize=function(a){var e=c.isAbsolute(a),f="/"===g(a,-1);return a=b(d(a.split("/"),function(a){return!!a}),!e).join("/"),a||e||(a="."),a&&f&&(a+="/"),(e?"/":"")+a},c.isAbsolute=function(a){return"/"===a.charAt(0)},c.join=function(){var a=Array.prototype.slice.call(arguments,0);return c.normalize(d(a,function(a){if("string"!=typeof a)throw new TypeError("Arguments to path.join must be strings");return a}).join("/"))},c.relative=function(a,b){function d(a){for(var b=0;b<a.length&&""===a[b];b++);for(var c=a.length-1;c>=0&&""===a[c];c--);return b>c?[]:a.slice(b,c-b+1)}a=c.resolve(a).substr(1),b=c.resolve(b).substr(1);for(var e=d(a.split("/")),f=d(b.split("/")),g=Math.min(e.length,f.length),h=g,i=0;g>i;i++)if(e[i]!==f[i]){h=i;break}for(var j=[],i=h;i<e.length;i++)j.push("..");return j=j.concat(f.slice(h)),j.join("/")},c.sep="/",c.delimiter=":",c.dirname=function(a){var b=f(a),c=b[0],d=b[1];return c||d?(d&&(d=d.substr(0,d.length-1)),c+d):"."},c.basename=function(a,b){var c=f(a)[2];return b&&c.substr(-1*b.length)===b&&(c=c.substr(0,c.length-b.length)),c},c.extname=function(a){return f(a)[3]};var g="b"==="ab".substr(-1)?function(a,b,c){return a.substr(b,c)}:function(a,b,c){return 0>b&&(b=a.length+b),a.substr(b,c)}}).call(this,a("/Users/kl0tl/dev/gameweek2014/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"))},{"/Users/kl0tl/dev/gameweek2014/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":1}],w1dNXB:[function(a,b){"use strict";var c,d,e;c=a("./loaders").AssetsLoader,d=a("./loaders").ImagesLoader,e=a("./loaders").JsonLoader,b.exports=new c("/assets").when(/\.(?:png|jpg)$/,new d).when(/\.json$/,new e)},{"./loaders":9}],"assets-loader":[function(a,b){b.exports=a("w1dNXB")},{}],5:[function(a){"use strict";var b,c,d,e,f,g,h;b=a("./assets-loader"),c=a("./nuclear_modules/game.transform"),d=a("./nuclear_modules/game.rendering"),e=a("./nuclear_modules/game.animations"),f=a("./nuclear_modules/game.lighting"),g=a("./nuclear_modules/game.collisions"),h=a("./nuclear_modules/game.inputs"),b.load(["atlases/prinny.atlas.png","atlases/prinny.atlas.json","animations/prinny/prinny@dancing.json"]).done(function(){nuclear.import([c,d,e,f,g,h]),console.log("modules loaded!"),a("./systems-context"),a("./scenes/collisions-scene"),window.requestAnimationFrame(function b(){window.requestAnimationFrame(b),nuclear.system.run()})}).progress(console.log.bind(console,"bundle progress"))},{"./assets-loader":"w1dNXB","./nuclear_modules/game.animations":12,"./nuclear_modules/game.collisions":15,"./nuclear_modules/game.inputs":18,"./nuclear_modules/game.lighting":23,"./nuclear_modules/game.rendering":29,"./nuclear_modules/game.transform":32,"./scenes/collisions-scene":35,"./systems-context":36}],6:[function(a,b){"use strict";function c(a){function b(a){return function(){var b,d;for(b=0;d=a[b];b+=1)d.apply(c,arguments)}}var c;c=this,c.assets=[],c._loadListeners=[],c._errorListeners=[],c._progressListeners=[],a.call(this,b(c._loadListeners),b(c._errorListeners),b(c._progressListeners))}c.prototype.done=function(a){return this._loadListeners.push(a),this},c.prototype.error=function(a){return this._errorListeners.push(a),this},c.prototype.progress=function(a){return this._progressListeners.push(a),this},b.exports=c},{}],7:[function(a,b){"use strict";function c(a){this.basePath=a||"/",this.cache=Object.create(null),this.rules=[]}var d,e;d=a("./assets-bundle"),e=a("path"),c.prototype.get=function(a){return this.cache[a]},c.prototype.has=function(a){return a in this.cache},c.prototype.when=function(a,b){return this.rules.push({pattern:a,loader:b}),this},c.prototype.load=function(a){var b;return b=this,new d(function(c,d,f){function g(a,d){return function(){var e;e=this,b.cache[a]=e,h.assets[d]=e,i+=1,f&&f(this,i/j),i===j&&c()}}var h,i,j,k,l,m,n,o;for(h=this,i=0,j=a.length,j||c(),k=0;j>k;k+=1)if(l=a[k],m=b.get(l))g(l,k).call(m);else for(n=0;o=b.rules[n];n+=1)o.pattern.test(l)&&o.loader.load(e.join(b.basePath,l),g(l,k),d)})},b.exports=c},{"./assets-bundle":6,path:2}],8:[function(a,b){"use strict";function c(){}c.prototype.load=function(a,b,c){var d=new Image;d.onload=b,d.onerror=c,d.src=a},b.exports=c},{}],9:[function(a,b,c){"use strict";c.AssetsLoader=a("./assets-loader"),c.ImagesLoader=a("./images-loader"),c.JsonLoader=a("./json-loader")},{"./assets-loader":7,"./images-loader":8,"./json-loader":10}],10:[function(a,b){"use strict";function c(){}c.prototype.load=function(a,b,c){var d=new XMLHttpRequest;d.open("GET",a),d.onreadystatechange=function(){if(!(d.readyState<4))if(200===d.status)try{b.call(JSON.parse(d.responseText))}catch(a){c(a)}else c(d)},d.send()},b.exports=c},{}],11:[function(a,b){"use strict";function c(a){var b,c,f,g;for(this.animations=Object.create(null),c=a.animations.length,b=0;c>b;b+=1)f=a.animations[b],g=e.get(d.join("animations",a.target,a.target+"@"+f+".json")),this.animations[f]=g;this.defaultAnimation=a.defaultAnimation||"idle",this.currentAnimation=this.defaultAnimation,this.currentFrame=0,this.loop=Boolean(a&&a.loop),this.timeElapsedSinceLastFrame=0}var d,e;d=a("path"),e=a("assets-loader"),b.exports=c},{"assets-loader":"w1dNXB",path:2}],12:[function(a,b){"use strict";var c;c=a("./components/animations-component"),b.exports=nuclear.module("game.animations",["game.rendering"]).component("animations",function(a,b,d){return new c(b,d)}).system("animate",["sprite from game.rendering","atlas from game.rendering","animations from game.animations"],a("./systems/animate-system"),{msPerUpdate:16})},{"./components/animations-component":11,"./systems/animate-system":13}],13:[function(a,b){"use strict";b.exports=function(a,b,c,d){var e,f,g,h,i,j,k;e=b.atlas,f=b.sprite,g=b.animations,h=g.animations[g.currentAnimation],g.timeElapsedSinceLastFrame+=16*d,g.timeElapsedSinceLastFrame>h.interval&&(g.currentFrame+=1,g.timeElapsedSinceLastFrame-=h.interval,g.currentFrame>h.frames.length-1&&(g.currentFrame=0,g.loop||(g.currentAnimation=g.defaultAnimation,h=g.animations[g.currentAnimation])),i=e.sprites.frames[h.frames[g.currentFrame]].frame,j=f.width(),k=f.height(),f.context.clearRect(0,0,j,k),f.context.drawImage(e.source,i.x,i.y,i.w,i.h,0,0,j,k))}},{}],14:[function(a,b){"use strict";function c(a){this.offsetX=a.offsetX||0,this.offsetY=a.offsetY||0,this.halfWidth=.5*a.width,this.halfHeight=.5*a.height,this._currentCollisions=Object.create(null),this._onCollisionEnterListeners=[],this._onCollisionExitListeners=[],this._onCollisionStayListeners=[]}c.prototype.onCollisionEnter=function(a){return this._onCollisionEnterListeners.push(a),this},c.prototype.onCollisionStay=function(a){return this._onCollisionStayListeners.push(a),this},c.prototype.onCollisionExit=function(a){return this._onCollisionExitListeners.push(a),this},c.prototype.triggerCollisionEnter=function(a,b){a in this._currentCollisions?this.triggerCollisionStay():(this._currentCollisions[a]=b,this._triggerCollisionListeners(this._onCollisionEnterListeners))},c.prototype.triggerCollisionStay=function(){this._triggerCollisionListeners(this._onCollisionStayListeners)},c.prototype.triggerCollisionExit=function(a){delete this._currentCollisions[a],this._triggerCollisionListeners(this._onCollisionExitListeners)},c.prototype._triggerCollisionListeners=function(a){var b,c;for(b=0;c=a[b];b+=1)c()},c.prototype.width=function(a){return 0===arguments.length?2*this.halfWidth:(this.halfWidth=.5*a,this)},c.prototype.height=function(a){return 0===arguments.length?this.halfHeight:(this.halfHeight=.5*a,this)},b.exports=c},{}],15:[function(a,b){"use strict";var c;c=a("./components/collider-component"),b.exports=nuclear.module("game.collisions",["game.transform"]).component("collider",function(a,b){return new c(b)}).system("collisions",["collider from game.collisions","position from game.transform","velocity from game.transform","rigidbody from game.transform"],a("./systems/collisions-system")).system("debug-colliders",["collider from game.collisions","position from game.transform"],a("./systems/debug-colliders-system"))},{"./components/collider-component":14,"./systems/collisions-system":16,"./systems/debug-colliders-system":17}],16:[function(a,b){"use strict";b.exports=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A;for(d=b.position,e=b.velocity,f=b.collider,g=b.rigidbody,h=e.x*e.x+e.y*e.y,A=g.inverseMass,i=d.x+f.offsetX,j=d.y+f.offsetY,k=c.colliders,l=k.length,m=0;l>m;m+=1)n=k[m],n!==a&&(o=nuclear.component("position").of(n),p=nuclear.component("collider").of(n),q=nuclear.component("rigidbody").of(n),r=o.x+p.offsetX,s=o.y+p.offsetY,t=r-i,u=s-j,v=Math.abs(t)-(f.halfWidth+p.halfWidth),w=Math.abs(u)-(f.halfHeight+p.halfHeight),-.1>v&&-.1>w?(x=Math.abs(e.x)/v||0,y=Math.abs(e.y)/w||0,z=A+q.inverseMass,(y>x||.1>h&&v>w)&&(0>t?(d.x-=v/(z/A||0),o.x+=v/(z/q.inverseMass||0)):t>0&&(d.x+=v/(z/A||0),o.x-=v/(z/q.inverseMass||0))),(x>y||.1>h&&w>v)&&(0>u?(d.y-=w/(z/A||0),o.y+=w/(z/q.inverseMass||0)):u>0&&(d.y+=w/(z/A||0),o.y-=w/(z/q.inverseMass||0))),i=d.x+f.offsetX,j=d.y+f.offsetY,n in f._currentCollisions?f.triggerCollisionStay(n):f.triggerCollisionEnter(n)):n in f._currentCollisions&&(h>1?f.triggerCollisionExit(n):f.triggerCollisionStay(n)))}},{}],17:[function(a,b){"use strict";b.exports=function(a,b,c){var d,e,f,g,h,i,j;d=c.dests[0],e=b.position,f=b.collider,g=e.x+f.offsetX,h=e.y+f.offsetY,i=f.halfWidth,j=f.halfHeight,d.save(),d.strokeStyle="#f0f",d.beginPath(),d.moveTo(g-i,h-j),d.lineTo(g+i,h-j),d.lineTo(g+i,h+j),d.lineTo(g-i,h+j),d.closePath(),d.stroke(),d.restore()}},{}],18:[function(a,b){"use strict";!function(c,d){function e(a,b){var c,d=b.inputs;for(var f in e.manager)c=e.manager[f],d[f]&&d[f](a,c,e.manager)}function f(a,b){var c=h.config("keyboard")[b];e.manager[c]=1}function g(a,b){var c=h.config("keyboard")[b];e.manager[c]=0}a("./lib/mousetrap.min");var h,i,j;i=a("./lib/gamepad.min").Gamepad,j=window.Mousetrap,h=c.module("game.inputs",[]),h.component("inputs",function(a,b){return b}),e.manager={},h.system("inputsManager",["inputs"],e,{msPerUpdate:50}),h.config({gamepad:{FACE_1:"",FACE_2:"",FACE_3:"",FACE_4:"",LEFT_TOP_SHOULDER:"",RIGHT_TOP_SHOULDER:"",LEFT_BOTTOM_SHOULDER:"",RIGHT_BOTTOM_SHOULDER:"",SELECT_BACK:"",START_FORWARD:"",LEFT_STICK_X:"LEFT_AXIS_X",RIGHT_STICK_X:"RIGHT_AXIS_X",LEFT_STICK_Y:"LEFT_AXIS_Y",RIGHT_STICK_Y:"RIGHT_AXIS_Y",DPAD_UP:"UP",DPAD_DOWN:"DOWN",DPAD_LEFT:"LEFT",DPAD_RIGHT:"RIGHT",HOME:""},keyboard:{a:"A",up:"UP",down:"DOWN",left:"LEFT",right:"RIGHT",z:"UP",q:"LEFT",s:"DOWN",d:"RIGHT"}});var k=new i;k.init(),k.bind(i.Event.CONNECTED,function(){d.log("[MODULE@INPUTS] GAMEPAD CONNECTED")}),k.bind(i.Event.UNCONNECTED,function(){d.log("[MODULE@INPUTS] GAMEPAD UNCONNECTED")}),k.bind(i.Event.BUTTON_DOWN,function(a){var b=h.config("gamepad")[a.control];e.manager[b]=1}),k.bind(i.Event.BUTTON_UP,function(a){var b=h.config("gamepad")[a.control];e.manager[b]=0}),k.bind(i.Event.AXIS_CHANGED,function(a){var b=h.config("gamepad")[a.axis];e.manager[b]=a.value});var l,m;m=h.config("keyboard");for(var n in m)l=n,j.bind(l,f,"keydown"),j.bind(l,g,"keyup");b.exports=h}(window.nuclear,window.console)},{"./lib/gamepad.min":19,"./lib/mousetrap.min":20}],19:[function(a,b){!function(a){"use strict";var b=function(){},c={getType:function(){return"null"},isSupported:function(){return!1},update:b},d=function(a){var c=this,d=window;this.update=b,this.requestAnimationFrame=a||d.requestAnimationFrame||d.webkitRequestAnimationFrame||d.mozRequestAnimationFrame,this.tickFunction=function(){c.update(),c.startTicker()},this.startTicker=function(){c.requestAnimationFrame.apply(d,[c.tickFunction])}};d.prototype.start=function(a){this.update=a||b,this.startTicker()};var e=function(){};e.prototype.update=b,e.prototype.start=function(a){this.update=a||b};var f=function(a,b){this.listener=a,this.gamepadGetter=b,this.knownGamepads=[]};f.factory=function(a){var b=c,d=window&&window.navigator;return d&&("undefined"!=typeof d.webkitGamepads?b=new f(a,function(){return d.webkitGamepads}):"undefined"!=typeof d.webkitGetGamepads&&(b=new f(a,function(){return d.webkitGetGamepads()}))),b},f.getType=function(){return"WebKit"},f.prototype.getType=function(){return f.getType()},f.prototype.isSupported=function(){return!0},f.prototype.update=function(){var a,b,c=this,d=Array.prototype.slice.call(this.gamepadGetter(),0);for(b=this.knownGamepads.length-1;b>=0;b--)a=this.knownGamepads[b],d.indexOf(a)<0&&(this.knownGamepads.splice(b,1),this.listener._disconnect(a));for(b=0;b<d.length;b++)a=d[b],a&&c.knownGamepads.indexOf(a)<0&&(c.knownGamepads.push(a),c.listener._connect(a))};var g=function(a){this.listener=a,window.addEventListener("gamepadconnected",function(b){a._connect(b.gamepad)}),window.addEventListener("gamepaddisconnected",function(b){a._disconnect(b.gamepad)})};g.factory=function(a){var b=c;return window&&"undefined"!=typeof window.addEventListener&&(b=new g(a)),b},g.getType=function(){return"Firefox"},g.prototype.getType=function(){return g.getType()},g.prototype.isSupported=function(){return!0},g.prototype.update=b;var h=function(a){this.updateStrategy=a||new d,this.gamepads=[],this.listeners={},this.platform=c,this.deadzone=.03,this.maximizeThreshold=.97};h.UpdateStrategies={AnimFrameUpdateStrategy:d,ManualUpdateStrategy:e},h.PlatformFactories=[f.factory,g.factory],h.Type={PLAYSTATION:"playstation",LOGITECH:"logitech",XBOX:"xbox",UNKNOWN:"unknown"},h.Event={CONNECTED:"connected",UNSUPPORTED:"unsupported",DISCONNECTED:"disconnected",TICK:"tick",BUTTON_DOWN:"button-down",BUTTON_UP:"button-up",AXIS_CHANGED:"axis-changed"},h.StandardButtons=["FACE_1","FACE_2","FACE_3","FACE_4","LEFT_TOP_SHOULDER","RIGHT_TOP_SHOULDER","LEFT_BOTTOM_SHOULDER","RIGHT_BOTTOM_SHOULDER","SELECT_BACK","START_FORWARD","LEFT_STICK","RIGHT_STICK","DPAD_UP","DPAD_DOWN","DPAD_LEFT","DPAD_RIGHT","HOME"],h.StandardAxes=["LEFT_STICK_X","LEFT_STICK_Y","RIGHT_STICK_X","RIGHT_STICK_Y"];var i=function(a,b,c){return b<a.length?a[b]:c+(b-a.length+1)};h.StandardMapping={env:{},buttons:{byButton:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]},axes:{byAxis:[0,1,2,3]}},h.Mappings=[{env:{platform:g.getType(),type:h.Type.PLAYSTATION},buttons:{byButton:[14,13,15,12,10,11,8,9,0,3,1,2,4,6,7,5,16]},axes:{byAxis:[0,1,2,3]}},{env:{platform:f.getType(),type:h.Type.LOGITECH},buttons:{byButton:[1,2,0,3,4,5,6,7,8,9,10,11,11,12,13,14,10]},axes:{byAxis:[0,1,2,3]}},{env:{platform:g.getType(),type:h.Type.LOGITECH},buttons:{byButton:[0,1,2,3,4,5,-1,-1,6,7,8,9,11,12,13,14,10],byAxis:[-1,-1,-1,-1,-1,-1,[2,0,1],[2,0,-1]]},axes:{byAxis:[0,1,3,4]}}],h.prototype.init=function(){var a=h.resolvePlatform(this),b=this;return this.platform=a,this.updateStrategy.start(function(){b._update()}),a.isSupported()},h.prototype.bind=function(a,b){return"undefined"==typeof this.listeners[a]&&(this.listeners[a]=[]),this.listeners[a].push(b),this},h.prototype.unbind=function(a,b){if("undefined"!=typeof a){if("undefined"!=typeof b){if("undefined"==typeof this.listeners[a])return!1;for(var c=0;c<this.listeners[a].length;c++)if(this.listeners[a][c]===b)return this.listeners[a].splice(c,1),!0;return!1}this.listeners[a]=[]}else this.listeners={}},h.prototype.count=function(){return this.gamepads.length},h.prototype._fire=function(a,b){if("undefined"!=typeof this.listeners[a])for(var c=0;c<this.listeners[a].length;c++)this.listeners[a][c].apply(this.listeners[a][c],[b])},h.getNullPlatform=function(){return Object.create(c)},h.resolvePlatform=function(a){var b,d=c;for(b=0;!d.isSupported()&&b<h.PlatformFactories.length;b++)d=h.PlatformFactories[b](a);return d},h.prototype._connect=function(a){var b,c,d=this._resolveMapping(a);for(a.state={},a.lastState={},a.updater=[],b=d.buttons.byButton.length,c=0;b>c;c++)this._addButtonUpdater(a,d,c);for(b=d.axes.byAxis.length,c=0;b>c;c++)this._addAxisUpdater(a,d,c);this.gamepads[a.index]=a,this._fire(h.Event.CONNECTED,a)},h.prototype._addButtonUpdater=function(a,c,d){var e=b,f=i(h.StandardButtons,d,"EXTRA_BUTTON_"),g=this._createButtonGetter(a,c.buttons,d),j=this,k={gamepad:a,control:f};a.state[f]=0,a.lastState[f]=0,e=function(){var b=g(),c=a.lastState[f],d=b>.5,e=c>.5;a.state[f]=b,d&&!e?j._fire(h.Event.BUTTON_DOWN,Object.create(k)):!d&&e&&j._fire(h.Event.BUTTON_UP,Object.create(k)),0!==b&&1!==b&&b!==c&&j._fireAxisChangedEvent(a,f,b),a.lastState[f]=b},a.updater.push(e)},h.prototype._addAxisUpdater=function(a,c,d){var e=b,f=i(h.StandardAxes,d,"EXTRA_AXIS_"),g=this._createAxisGetter(a,c.axes,d),j=this;a.state[f]=0,a.lastState[f]=0,e=function(){var b=g(),c=a.lastState[f];a.state[f]=b,b!==c&&j._fireAxisChangedEvent(a,f,b),a.lastState[f]=b},a.updater.push(e)},h.prototype._fireAxisChangedEvent=function(a,b,c){var d={gamepad:a,axis:b,value:c};this._fire(h.Event.AXIS_CHANGED,d)},h.prototype._createButtonGetter=function(){var a=function(){return 0},b=function(b,c,d){var e=a;return d>c?e=function(){var a=d-c,e=b();return e=(e-c)/a,0>e?0:e}:c>d&&(e=function(){var a=c-d,e=b();return e=(e-d)/a,e>1?0:1-e}),e},c=function(a){return"[object Array]"===Object.prototype.toString.call(a)};return function(d,e,f){var g,h=a,i=this;return g=e.byButton[f],-1!==g?"number"==typeof g&&g<d.buttons.length&&(h=function(){return d.buttons[g]}):e.byAxis&&f<e.byAxis.length&&(g=e.byAxis[f],c(g)&&3==g.length&&g[0]<d.axes.length&&(h=function(){var a=d.axes[g[0]];return i._applyDeadzoneMaximize(a)},h=b(h,g[1],g[2]))),h}}(),h.prototype._createAxisGetter=function(){var a=function(){return 0};return function(b,c,d){var e,f=a,g=this;return e=c.byAxis[d],-1!==e&&"number"==typeof e&&e<b.axes.length&&(f=function(){var a=b.axes[e];return g._applyDeadzoneMaximize(a)}),f}}(),h.prototype._disconnect=function(a){var b,c=[];for("undefined"!=typeof this.gamepads[a.index]&&delete this.gamepads[a.index],b=0;b<this.gamepads.length;b++)"undefined"!=typeof this.gamepads[b]&&(c[b]=this.gamepads[b]);this.gamepads=c,this._fire(h.Event.DISCONNECTED,a)},h.prototype._resolveControllerType=function(a){return a=a.toLowerCase(),-1!==a.indexOf("playstation")?h.Type.PLAYSTATION:-1!==a.indexOf("logitech")||-1!==a.indexOf("wireless gamepad")?h.Type.LOGITECH:-1!==a.indexOf("xbox")||-1!==a.indexOf("360")?h.Type.XBOX:h.Type.UNKNOWN},h.prototype._resolveMapping=function(a){var b,c,d=h.Mappings,e=null,f={platform:this.platform.getType(),type:this._resolveControllerType(a.id)};for(b=0;!e&&b<d.length;b++)c=d[b],h.envMatchesFilter(c.env,f)&&(e=c);return e||h.StandardMapping},h.envMatchesFilter=function(a,b){var c,d=!0;for(c in a)a[c]!==b[c]&&(d=!1);return d},h.prototype._update=function(){this.platform.update(),this.gamepads.forEach(function(a){a&&a.updater.forEach(function(a){a()})}),this.gamepads.length>0&&this._fire(h.Event.TICK,this.gamepads)},h.prototype._applyDeadzoneMaximize=function(a,b,c){return b="undefined"!=typeof b?b:this.deadzone,c="undefined"!=typeof c?c:this.maximizeThreshold,a>=0?b>a?a=0:a>c&&(a=1):a>-b?a=0:-c>a&&(a=-1),a},a.Gamepad=h}("undefined"!=typeof b&&b.exports||window)},{}],20:[function(){!function(a,b,c){function d(a,b,c){a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent("on"+b,c)}function e(a){if("keypress"==a.type){var b=String.fromCharCode(a.which);return a.shiftKey||(b=b.toLowerCase()),b}return q[a.which]?q[a.which]:r[a.which]?r[a.which]:String.fromCharCode(a.which).toLowerCase()}function f(a){a=a||{};var b,c=!1;for(b in w)a[b]?c=!0:w[b]=0;c||(z=!1)}function g(a,b,c,d,e,f){var g,h,i=[],j=c.type;if(!u[a])return[];for("keyup"==j&&k(a)&&(b=[a]),g=0;g<u[a].length;++g)if(h=u[a][g],!(!d&&h.seq&&w[h.seq]!=h.level||j!=h.action||("keypress"!=j||c.metaKey||c.ctrlKey)&&b.sort().join(",")!==h.modifiers.sort().join(","))){var l=d&&h.seq==d&&h.level==f;(!d&&h.combo==e||l)&&u[a].splice(g,1),i.push(h)}return i}function h(a){var b=[];return a.shiftKey&&b.push("shift"),a.altKey&&b.push("alt"),a.ctrlKey&&b.push("ctrl"),a.metaKey&&b.push("meta"),b}function i(a,b,c,d){A.stopCallback(b,b.target||b.srcElement,c,d)||!1!==a(b,c)||(b.preventDefault?b.preventDefault():b.returnValue=!1,b.stopPropagation?b.stopPropagation():b.cancelBubble=!0)}function j(a){"number"!=typeof a.which&&(a.which=a.keyCode);var b=e(a);b&&("keyup"==a.type&&x===b?x=!1:A.handleKey(b,h(a),a))}function k(a){return"shift"==a||"ctrl"==a||"alt"==a||"meta"==a}function l(a,b,c,d){function g(b){return function(){z=b,++w[a],clearTimeout(p),p=setTimeout(f,1e3)}}function h(b){i(c,b,a),"keyup"!==d&&(x=e(b)),setTimeout(f,10)}for(var j=w[a]=0;j<b.length;++j){var k=j+1===b.length?h:g(d||m(b[j+1]).action);n(b[j],k,d,a,j)}}function m(a,b){var c,d,e,f=[];for(c="+"===a?["+"]:a.split("+"),e=0;e<c.length;++e)d=c[e],t[d]&&(d=t[d]),b&&"keypress"!=b&&s[d]&&(d=s[d],f.push("shift")),k(d)&&f.push(d);if(c=d,e=b,!e){if(!o){o={};for(var g in q)g>95&&112>g||q.hasOwnProperty(g)&&(o[q[g]]=g)}e=o[c]?"keydown":"keypress"}return"keypress"==e&&f.length&&(e="keydown"),{key:d,modifiers:f,action:e}}function n(a,b,c,d,e){v[a+":"+c]=b,a=a.replace(/\s+/g," ");var f=a.split(" ");1<f.length?l(a,f,b,c):(c=m(a,c),u[c.key]=u[c.key]||[],g(c.key,c.modifiers,{type:c.action},d,a,e),u[c.key][d?"unshift":"push"]({callback:b,modifiers:c.modifiers,action:c.action,seq:d,level:e,combo:a}))}var o,p,q={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},r={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},s={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},t={option:"alt",command:"meta","return":"enter",escape:"esc",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},u={},v={},w={},x=!1,y=!1,z=!1;for(c=1;20>c;++c)q[111+c]="f"+c;for(c=0;9>=c;++c)q[c+96]=c;d(b,"keypress",j),d(b,"keydown",j),d(b,"keyup",j);var A={bind:function(a,b,c){a=a instanceof Array?a:[a];for(var d=0;d<a.length;++d)n(a[d],b,c);return this},unbind:function(a,b){return A.bind(a,function(){},b)},trigger:function(a,b){return v[a+":"+b]&&v[a+":"+b]({},a),this},reset:function(){return u={},v={},this},stopCallback:function(a,b){return-1<(" "+b.className+" ").indexOf(" mousetrap ")?!1:"INPUT"==b.tagName||"SELECT"==b.tagName||"TEXTAREA"==b.tagName||b.isContentEditable},handleKey:function(a,b,c){var d,e=g(a,b,c);b={};var h=0,j=!1;for(d=0;d<e.length;++d)e[d].seq&&(h=Math.max(h,e[d].level));for(d=0;d<e.length;++d)e[d].seq?e[d].level==h&&(j=!0,b[e[d].seq]=1,i(e[d].callback,c,e[d].combo,e[d].seq)):j||i(e[d].callback,c,e[d].combo);e="keypress"==c.type&&y,c.type!=z||k(a)||e||f(b),y=j&&"keydown"==c.type}};a.Mousetrap=A,"function"==typeof define&&define.amd&&define(A)}(window,document)},{}],21:[function(a,b){"use strict";function c(a){this.shape=[],this.color=a.color,this.radius=a.radius,this.intensity=a.intensity}b.exports=c},{}],22:[function(a,b){"use strict";function c(a){this.shape=a}b.exports=c},{}],23:[function(a,b){"use strict";var c,d;c=a("./components/light-component"),d=a("./components/occluder-component"),b.exports=nuclear.module("game.lighting",[]).component("occluder",function(a,b){return new d(b)}).component("light",function(a,b){return new c(b)}).system("shadowing",["occluder from game.lighting"],a("./systems/shadowing-system")).system("lighting",["light from game.lighting","position from game.transform"],a("./systems/lighting-system")).system("debug-occluders",["occluder from game.lighting","position from game.transform"],a("./systems/debug-occluders-system"))},{"./components/light-component":21,"./components/occluder-component":22,"./systems/debug-occluders-system":24,"./systems/lighting-system":25,"./systems/shadowing-system":26}],24:[function(a,b){"use strict";b.exports=function(a,b,c){var d,e,f,g;for(d=c.dests[0],e=b.occluder.shape,f=e.length,d.save(),d.translate(b.position.x,b.position.y),d.fillStyle="black",d.moveTo(e[0],e[1]),g=2;f>g;g+=2)d.lineTo(e[g],e[g+1]);d.closePath(),d.fill(),d.restore()}},{}],25:[function(a,b){"use strict";b.exports=function(){}},{}],26:[function(a,b){"use strict";nuclear.events.on("system:before:shadowing from game.lighting",function(){var a,b,c,d;for(a=nuclear.component("light"),b=nuclear.system.context(),c=0;d=b.lights[c];c+=1)a.of(d).shape.length=0}),b.exports=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z;for(d=nuclear.component("light"),e=nuclear.component("position"),f=c.dests[0],f.save(),g=c.lights,h=b.position,i=b.occluder.shape,j=0;k=g[j];j+=1){for(l=e.of(k),m=d.of(k),r=l.x,s=l.y,o=i.length,n=0;o>n&&(v=i[n],w=i[(n+1)%o],t=v-r,u=w-s,x=i[(n+2)%o]-v,y=i[(n+3)%o]-w,q=(t*(w-s)+u*(r-v))/(x*u-y*t),p=(v+x*q-r)/t,!(0>p))&&!(0>q||q>1);n+=2)z=Math.sqrt(x*x+y*y),m.shape.push(v+x*z*q,w+y*q);for(o=m.shape.length,f.strokeStyle="red",n=0;o>n;n+=2)f.beginPath(),f.moveTo(r,s),f.lineTo(m.shape[n],m.shape[n+1]),f.closePath(),f.stroke()}f.restore()}},{}],27:[function(a,b){"use strict";function c(a){this.source=e.get(d.join("atlases",a+".atlas.png")),this.sprites=e.get(d.join("atlases",a+".atlas.json"))}var d,e;d=a("path"),e=a("assets-loader"),b.exports=c},{"assets-loader":"w1dNXB",path:2}],28:[function(a,b){"use strict";function c(a,b,c){this.buffer=document.createElement("canvas"),this.context=this.buffer.getContext("2d"),this.dest=c||0,this.buffer.width=a,this.buffer.height=b,this.context.imageSmoothingEnabled=!1}var d,e;d=a("path"),e=a("assets-loader"),c.prototype.fromAtlas=function(a,b){var c,f,g,h;c=e.get(d.join("atlases",a+".atlas.png")),f=e.get(d.join("atlases",a+".atlas.json")).frames[b],g=f.frame.w,h=f.frame.h,this.width(g),this.height(h),this.context.drawImage(c,f.frame.x,f.frame.y,g,h,0,0,g,h)},c.prototype.width=function(a){return 0===arguments.length?this.buffer.width:(this.buffer.width=a,this.context.imageSmoothingEnabled=!1,this)},c.prototype.height=function(a){return 0===arguments.length?this.buffer.height:(this.buffer.height=a,this.context.imageSmoothingEnabled=!1,this)},b.exports=c},{"assets-loader":"w1dNXB",path:2}],29:[function(a,b){"use strict";var c,d;c=a("./components/atlas-component"),d=a("./components/sprite-component"),nuclear.events.on("system:before:renderer from game.rendering",function(){}),b.exports=nuclear.module("game.rendering",["game.transform"]).component("atlas",function(a,b){return new c(b)}).component("sprite",function(a,b,c,e){return new d(b,c,e)}).system("renderer",["sprite from game.rendering","position from game.transform"],a("./systems/renderer-system"))},{"./components/atlas-component":27,"./components/sprite-component":28,"./systems/renderer-system":30}],30:[function(a,b){"use strict";nuclear.events.on("system:before:renderer from game.rendering",function(){var a;a=nuclear.system.context(),a.dests[0].clearRect(0,0,a.WIDTH,a.HEIGHT)}),b.exports=function(a,b,c){var d,e,f,g,h;d=b.sprite,e=b.position,f=c.dests[d.dest],g=d.width(),h=d.height(),f.drawImage(d.buffer,e.x-.5*g,e.y-.5*h,g,h)}},{}],31:[function(a,b){"use strict";function c(a){this._mass=a.mass||1,this.inverseMass=1/this._mass,this.friction=a.friction||0}c.prototype.mass=function(a){return 0===arguments.length?this._mass:(this._mass=a,this.inverseMass=1/a,this)},b.exports=c},{}],32:[function(a,b){"use strict";var c,d;c=a("./components/rigidbody-component"),d=a("./vec2"),b.exports=nuclear.module("game.transform",[]).component("position",function(a,b,c){return d(b,c)}).component("velocity",function(a,b,c){return d(b,c)}).component("rigidbody",function(a,b){return new c(b)}).system("kinematic",["position from game.transform","velocity from game.transform","rigidbody from game.transform"],a("./systems/kinematic-system"))},{"./components/rigidbody-component":31,"./systems/kinematic-system":33,"./vec2":34}],33:[function(a,b){"use strict";b.exports=function(a,b,c,d){var e;e=b.rigidbody.friction,b.position.x+=b.velocity.x*d,b.position.y+=b.velocity.y*d,b.velocity.x*=e,b.velocity.y*=e}},{}],34:[function(a,b){"use strict";b.exports=function(a,b){return{x:a||0,y:b||0}}},{}],35:[function(){"use strict";var a,b,c,d;for(a=nuclear.system.context(),b=nuclear.entity.create(),nuclear.component("position").add(b,250,250),nuclear.component("sprite").add(b).fromAtlas("prinny",0),nuclear.component("atlas").add(b,"prinny"),nuclear.component("animations").add(b,{target:"prinny",animations:["dancing"],defaultAnimation:"dancing"}),nuclear.component("velocity").add(b),nuclear.component("collider").add(b,{width:74,height:121}),nuclear.component("rigidbody").add(b,{mass:1,friction:.75}),nuclear.component("inputs").add(b,{UP:function(a,b){nuclear.component("velocity").of(a).y-=5*b},DOWN:function(a,b){nuclear.component("velocity").of(a).y+=5*b},LEFT:function(a,b){nuclear.component("velocity").of(a).x-=5*b},RIGHT:function(a,b){nuclear.component("velocity").of(a).x+=5*b}}),d=0;10>d;d+=1)c=nuclear.entity.create(),nuclear.component("position").add(c,Math.random()*a.WIDTH,Math.random()*a.HEIGHT),nuclear.component("collider").add(c,{width:50*Math.random()|25,height:50*Math.random()|25}),nuclear.component("velocity").add(c),nuclear.component("rigidbody").add(c,{mass:.1,friction:0});nuclear.system.priority("kinematic",-2),nuclear.system.priority("collisions",-1)},{}],36:[function(){"use strict";var a;a=nuclear.system.context(),a.dests=[document.getElementById("screen").getContext("2d")],a.WIDTH=a.dests[0].canvas.width,a.HEIGHT=a.dests[0].canvas.height,a.lights=nuclear.system("lighting").query.entities,a.colliders=nuclear.query(["collider from game.collisions","position from game.transform","rigidbody from game.transform"].join(" ")).entities},{}]},{},[5]);